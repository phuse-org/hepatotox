[
  {
    "objectID": "maindraft.html",
    "href": "maindraft.html",
    "title": "Hepatotox Catalog",
    "section": "",
    "text": "Hepatotox Catalog\n\nThe catalog is a series of outputs for a Stage 1 Hepatotoxicity white paper considering a set of aggregate analyses and displays to rule out potential drug-induced liver injury (DILI). The catalog was generated using TERN and random.cdisc.data packages.\nThis repository provides a collection of hepatotoxicity-related analyses and outputs generated using the R language. The target audience is the clinical trials community, including statisticians, data scientists, and other professionals interested in applying R to clinical trials data.\n\nWhite Paper\nThe analyses and displays in this catalog were based on the recommendations in a white paper developed by the PHUSE Safety Analytics working group. The white paper is titled:\n“Recommendations for Analyses and Displays Associated with Hepatotoxicity with a Focus on Phase 2–4 Clinical Trials and Integrated Submission Documents. Stage 1: Initial Assessment and Screening for Potential of Hepatotoxicity.”\nView PDF\n\n\nShiny App Demo\nThe following is an output comparing maximum total bilirubin vs. maximum other liver enzymes (ALT, AST, or ALP).\nInteract with the Shiny App directly below:\n\n\nUsage Setup and pre-processing of synthetic data.\nThe output generated by the given code.\nAn interactive application that can alternatively be used to produce and interact with the graph. Interacting with Catalog R Code The full source code of each article can be viewed by viewing the on the “Source Code” code block at the top of the page and copied using the “Copy” button.\nIndividual code chunks from within the article can also be viewed and copied. The Reproducibility tab contains session information and allows one to install the packages required to properly run the code.\n\n\nLicense\nThis catalog as well as code examples are licensed under the Apache License, Version 2.0 - see the LICENSE file for details.\n\n\nContributing\nWe welcome contributions big and small to the TLG catalog. Please refer to the Contributing guide for more information on how you can contribute.\nDevelopment This website is built using Quarto and hosted on GitHub Pages."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "index",
    "section": "",
    "text": "#| min-lines: 6\n#| max-lines: 25\nlibrary(tidyverse)\nlibrary(magrittr)\nlibrary(tern)\nlibrary(dplyr)\nlibrary(r2rtf)\nlibrary(formatters)\n\n#Load Insight Engineering's CADHY data to use as a dataset.\ndownload.file(\n  url = \"https://raw.githubusercontent.com/phuse-org/hepatotox/main/cadhy.RData\",\n  destfile = \"cadhy.RData\",\n  mode = \"wb\"   # important for binary files!\n)\n\nload(\"cadhy.RData\")\n\n#Set seed for reproducibility.#\nset.seed(619)\n\n#Removed any NA values. Also, added a record sequence number via RUNNUM.\nadhy &lt;- df_explicit_na(cadhy)\ncadhy2 &lt;- adhy %&gt;% add_column(RUNNUM=runif(nrow(.)))\n\n# Define values of interest in PARAMCD variable.\nparamcd_tbili_alt &lt;- c(\"BLAL\", \"BGAL\", \"BA2AL\", \"BA5AL\")\nparamcd_tbili_ast &lt;- c(\"BLAS\", \"BGAS\", \"BA2AS\", \"BA5AS\")\nparam_extra &lt;- c(\"BL2AL2CB\", \"BL2AL2CU\", \"BL2AS2CB\", \"BL2AS2CU\")\n\n# Select laboratory test parameters.\nadhy_liver_tot &lt;- cadhy2 %&gt;%\n  filter(\n    SAFFL == \"Y\",\n    AVISIT %in% c(\"POST-BASELINE\"),\n    PARAMCD %in% c(paramcd_tbili_alt, paramcd_tbili_ast, param_extra),\n    AVAL %in% c(0, 1, 2, 3, 4)\n  )\n\n#ADaM Programmers should have already included a variable\n#similar to BIOCHEMREL & ADVREL that follow the metadata's criteria for findings\n#related to biochemical tests & findings related to adverse events, respectively.\nadhy_liver2 &lt;- cadhy2 %&gt;% mutate(BIOCHEMREL = ifelse(.8 &gt; RUNNUM & RUNNUM &gt; .5, \n                                                     \"Yes\", \"No\")) %&gt;% \n  mutate(ADVREL = ifelse(.55 &gt; RUNNUM & RUNNUM &gt; .25, \"Yes\", \"No\")) %&gt;% \n  filter(\n    SAFFL == \"Y\",\n    AVISIT %in% c(\"POST-BASELINE\"),\n    PARAMCD %in% c(paramcd_tbili_alt, paramcd_tbili_ast, param_extra),\n    AVAL %in% c(1, 2, 3, 4)\n  )\n\n#Add appropriate labels for final table output.\nadhy_liver3 &lt;- adhy_liver2 %&gt;% \n  mutate(FINBOTH = with_label(BIOCHEMREL == \"Yes\" &\n                                ADVREL == \"Yes\", \"Findings Related to Both Adverse Events and Biochemical Tests\"),\n         FINAEREL = with_label(ADVREL == \"Yes\", \"Findings Related to Adverse Events\"),\n         FINBCTEST = with_label(BIOCHEMREL == \"Yes\", \"Findings Related to Biochemical Tests\")\n  ) \n\ntable(adhy_liver3$FINBOTH, adhy_liver3$ACTARM)\ntable(adhy_liver3$ACTARMCD, adhy_liver3$FINAEREL)\n\n#Flag total number of findings without duplicates.\nadhy_liver4 &lt;- adhy_liver3 %&gt;%                                                  \n  mutate(TOP = case_when(ADVREL == \"Yes\" & BIOCHEMREL == \"No\"\n                         & FINBOTH == \"FALSE\"~\"Y\", ADVREL == \"No\" & BIOCHEMREL == \"Yes\" & FINBOTH\n                         == \"FALSE\"~\"Y\", .default = \"N\")) %&gt;% \n  mutate(TABLESEQ = RUNNUM) %&gt;% \n  mutate(FINTOP = with_label(TOP == \"Y\", \"Any Potential Liver Safety Findings\")) %&gt;%\n  mutate(ROWSPL1 = case_when(FINTOP == \"FALSE\" | FINTOP == \"TRUE\" ~ \" \")) \n\n#Rename the treatment arms.\nlevels(adhy_liver4$ACTARMCD) &lt;- c(\"T1\", \"PL\", \"T2\")\nlevels(adhy_liver4$ACTARM) &lt;- c(\"Treatment 1\", \"Placebo\", \"Treatment 2\")\n\nadhy_liver4$ACTARMCD &lt;- factor(adhy_liver4$ACTARMCD,levels = c(\"PL\", \"T1\", \"T2\")) \naefin_vars &lt;- c(\"FINBOTH\", \"FINAEREL\", \"FINBCTEST\")\n\n#Create a custom format function.\nformat_frac_perc &lt;- function(x, output = NULL) {  \n  # x[1] is N, x[2] is the % (as decimal)\n  perc &lt;- round(x[2] * 100, 1)\n  denom &lt;- (x[1] / (x[2] * 100)) * 100 # Calculate denominator\n  paste0(x[1],\"/\", denom, \" (\", perc, \"%)\")\n}\n\n#Build & render table's pseudo facet 1a.\nlyt_fin1a &lt;- basic_table(show_colcounts = TRUE) %&gt;% \n  split_rows_by(c(\"ROWSPL1\")) %&gt;%\n  split_cols_by(\"ACTARMCD\", split_fun = add_riskdiff(arm_x = c(\"T1\"), arm_y = c(\"PL\"), col_label = paste0(\"\\n\", \"Risk\", \"\\n\", \"Difference\", \"\\n\", \n c(\"T1\"), \"-\", c(\"PL\"), \"\\n\", \"(95% CI)\"))) %&gt;% \n  count_patients_with_event(\n    \"TABLESEQ\",\n    filters = c(\"TOP\"=\"Y\"),\n    denom = \"N_col\", riskdiff = TRUE,\n    .labels = c(count_fraction = \"Any Potential Liver Safety Findings\"),\n    .formats = c(count_fraction = format_frac_perc)) \n\nresult_tabtop1a &lt;- build_table(lyt_fin1a, df = adhy_liver4)\nprint(result_tabtop1a)\n\n#Build & render table's pseudo facet 1b.\nlyt_fin1b &lt;- basic_table(show_colcounts = TRUE) %&gt;% \n  split_rows_by(c(\"ROWSPL1\")) %&gt;%\n  split_cols_by(\"ACTARMCD\", split_fun = add_riskdiff(arm_x = c(\"T2\"),\n   arm_y = c(\"PL\", \"T1\"), col_label = paste0(\"Risk\", \"\\n\", \"Difference\", \n   \"\\n\", \"T2-\",  c(\"PL\", \"T1\"), \"\\n\", \"(95% CI)\"))) %&gt;% \n  count_patients_with_event(\n    \"TABLESEQ\",\n    filters = c(\"TOP\"=\"Y\"),\n    denom = \"N_col\", riskdiff = TRUE,\n    .labels = c(count_fraction = \"Any Potential Liver Safety Findings\"),\n    .formats = c(count_fraction = format_frac_perc))\n\nresult_tabtop1b &lt;- build_table(lyt_fin1b, df = adhy_liver4)\nprint(result_tabtop1b)\n\n\n#Bind specific columns from 2 top facets: 1a & 1b 1d.\nresulttopfin &lt;- cbind_rtables(result_tabtop1a[, 1:ncol(result_tabtop1a)], \n                              result_tabtop1b[, 4:ncol(result_tabtop1b)])\n\n#Constructing & rendering the bottom half of the table: facet 2a.\nlyt_fin2a &lt;- basic_table(show_colcounts = TRUE) %&gt;%\n  split_cols_by(\"ACTARMCD\", split_fun = add_riskdiff(arm_x = c(\"T1\"), \n                                                     arm_y = c(\"PL\"), col_label = paste0(\"\\n\", \"Risk\", \"\\n\", \"Difference\", \"\\n\", \n                                                                                         c(\"T1\"), \"-\", c(\"PL\"), \"\\n\", \"(95% CI)\"))) %&gt;%\n  count_patients_with_flags(\n    \"RUNNUM\",\n    flag_variables = aefin_vars,\n    denom = \"N_col\",\n    var_labels = \"\",\n    show_labels = \"visible\", \n    riskdiff = TRUE,\n    .formats = c(count_fraction = format_frac_perc),\n    .indent_mods = 1\n  )\n\nresult_tabbot2a &lt;- build_table(lyt_fin2a, df = adhy_liver4)\n\n#Constructing & rendering the bottom half of the table: facet 2b.\nlyt_fin2b &lt;- basic_table(show_colcounts = TRUE) %&gt;% \n  split_cols_by(\"ACTARMCD\", split_fun = add_riskdiff(arm_x = c(\"T2\"),\n                                                     arm_y = c(\"PL\", \"T1\"), col_label = paste0(\"Risk\", \"\\n\", \"Difference\", \n                                                                                               \"\\n\", \"T2-\",  c(\"PL\", \"T1\"), \"\\n\", \"(95% CI)\"))) %&gt;% \n  count_patients_with_flags(\n    \"RUNNUM\",\n    flag_variables = aefin_vars,\n    denom = \"N_col\",\n    var_labels = \"\",\n    show_labels = \"visible\", \n    riskdiff = TRUE,\n    .formats = c(count_fraction = format_frac_perc),\n    .indent_mods = \n  )\n\nresult_tabbot2b &lt;- build_table(lyt_fin2b, df = adhy_liver4)\n\n#Bind specific columns from all 4 facets: 2a & 2b.\nresultbot &lt;- cbind_rtables(result_tabbot2a[, 1:ncol(result_tabbot2a)], \n                           result_tabbot2b[, 4:ncol(result_tabbot2b)])\n\n\n#Bind specific rows from top & bottom halves of the table.\nresultfin &lt;- rbind(\n  resulttopfin[nrow(resulttopfin), ],\n  resultbot[3:nrow(resultbot), ],\n  resultbot[2, ]\n)\n\nresultfin2 &lt;- insert_rrow(resultfin, rrow(\"Number of Subjects with Liver\\nSafety Findings(a)\"), at = 1)\n\nmain_title(resultfin2) &lt;- paste(\"Table 1\", \n                                \"\\nOverview of Reported Potential Liver Safety Findings\", \"\\n&lt;Analysis Set&gt;\")\nmain_footer(resultfin2) &lt;-paste(\"PL=Placebo, T1=Treatment 1, T2=Treatment 2\",\n                                \"\\nNote (a): A potential liver safety finding is defined as meeting any of the laboratory thresholds.\",\n                                \"\\nN = number of applicable subjects in treatment arm; n = actual applicable observed number with values.\")\n\nprint(resultfin2)"
  }
]